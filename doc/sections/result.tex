\documentclass[doc/report.tex]{subfiles}

% Present the details of your experiments and their results.

\begin{document}

\section{Experiments and Results}
% TODO
\subsection{Feature Extraction from Pretrained AlexNet}
Table 1 describes the performance of various classifers that were trained based on the features extracted from the last fully connected layer (FC8) of the AlexNet and the last pooling layers of ResNet18 and ResNet50. Image Augmnetation techniques such as translation and rotation seemed to be having a negative impact on the perfromance of these classifers and hence were not included in the results.

\begin{table}[h]
\centering
\caption{Accuracy of various trained classifers}
\label{tab:my-table1}
\begin{tabular}{|l|c|c|}
\hline
\multicolumn{1}{|c|}{Pre-Trained Model} & Classifier                                 & Accuracy \\ \hline
AlexNet                                 & SVM                                        & 99.04\%  \\ \hline
AlexNet                                 & KNN                                        & 98.39\%  \\ \hline
AlexNet                                 & Naïve Bayes                                & 98.39\%  \\ \hline
AlexNet                                 & Discriminant Analysis                      & 99.22\%  \\ \hline
ResNet18                                & SVM                                        & 99.83\%  \\ \hline
ResNet18                                & KNN                                        & 99.57\%  \\ \hline
ResNet18                                & Naïve Bayes                                & 99.00\%  \\ \hline
ResNet18                                & Discriminant Analysis                      & 99.83\%  \\ \hline
ResNet50                                & SVM                                        & 99.96\%  \\ \hline
ResNet50                                & KNN                                        & 99.76\%  \\ \hline
ResNet50                                & Naïve Bayes                                & 99.26\%  \\ \hline
ResNet50                                & \multicolumn{1}{l|}{Discriminant Analysis} & 99.87\%  \\ \hline
\end{tabular}%
\end{table}

\subsection{Retraining the pretrained AlexNet}
The transfer learning model was trained over the training image datset using MATLAB 2018b on a Windows 10 Operating System on a single core i3 CPU with 8GB of RAM. While the initial results from the trained classier were promising, by means of training data augmentation and optimization of the training parameters we are able to acheive a very accurate classifier while also reducing the training time by half. Table 2 depicts the effect of training parameters on the classifeir performance. The choice of the optimization parameters and their corresponding effects have been described briefly in the follwoing sub-sections.

\begin{table}[h]
\centering
\caption{Training Parameter Analysis}
\label{tab:my-table2}
\resizebox{\textwidth}{!}{%
\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
\hline
\# & LR & Epochs & Batch Size & LR Drop Period & LR Drop Factor & Validation Accuracy & Test Accuracy & Time \\ \hline
1 & 0.0005 & 8 & 512 & 2 & 0.9 & 92.83\% & 93.57\% & 22 min \\ \hline
2 & 0.0005 & 8 & 256 & 2 & 0.9 & 92.61\% & 93.91\% & 22min  \\ \hline
3 & 0.0005 & 8 & 128 & 2 & 0.9 & 96.20\% & 97.39\% & 25min  \\ \hline
4 & 0.0005 & 8 & 128 & 2 & 0.6 & 97.50\% & 97.96\% & 25min  \\ \hline
5 & 0.0005 & 4 & 128 & 2 & 0.6 & 95.54\% & 95.48\% & 13min  \\ \hline
6 & 0.0001 & 4 & 128 & 2 & 0.6 & 98.91\% & 99.04\% & 13min  \\ \hline
7 & 0.0001 & 4 & 128 & 1 & 0.6 & 99.35\% & 99.09\% & 12min  \\ \hline
\end{tabular}%
}
\end{table}

\subsection{Experiments with self-organizing map}
A classifier using SOM was implemented and tested with different features.  The
results are shown in table \ref{tbl:som}. LBP $W$x$H$/$n$ means that the
images were resized to WxH and then split into $n\times n$ cells.
    
\begin{table}[h]
    \centering
    \begin{tabular}{lrlrr}
        features & feature count & classifier & time (minutes) & accuracy \\\hline
        AlexNet & 4096 & SOM 8x8 & 15 & 98\% \\
        LBP 100x100/10 + SURF & 6400 & SOM 8x8 & ?? & 80\% \\
        LBP 100x100/16 & 2891 & SOM 16x16 & 40 & 75\% \\
        LBP 100x100/10 & 5900 & SOM 8x8 & 32 & 74\% \\
        SURF & 500 & SOM 8x8 & 55 & 74\% \\
        LBP 100x100/16 & 2891 & SOM 8x8 & 20 & 73\% \\
        LBP 100x100/16 & 2891 & SOM 32x32 & 240 & 73\% \\
        LBP 100x100/16 & 2891 & SOM 6x6 & 7 & 69\% \\
        LBP 100x100/16 & 2891 & SOM 4x4 & 4 & 63\% \\
        grayscale 100x100 & 10000 & SOM 8x8 & 40 & 60\% \\
    \end{tabular}%
    \caption{Result of experiments, sorted by accuracy.}
    \label{tbl:som}
\end{table}

\end{document}
